{{define "game-board"}}
<div
    id="game-board"
    class="mx-auto"
    style="max-width: 350px"
    role="grid"
    aria-label="Word guess grid"
>
    {{range $row, $guesses := .game.Guesses}}
    <div
        class="guess-row d-flex justify-content-center mb-1"
        role="row"
        aria-label="Guess row {{add $row 1}}"
    >
        {{range $col, $guess := $guesses}}
        <div
            class="tile border border-2 rounded d-flex align-items-center justify-content-center fw-bold text-uppercase mx-1
                           {{if $guess.Letter}}filled tile-{{$guess.Status}}{{end}}
                           {{if and (eq $row $.game.CurrentRow) (not $.game.GameOver) (not $guess.Letter)}}tile-active{{end}}"
            role="gridcell"
            :aria-label="getTileAriaLabel({{$row}}, {{$col}}, '{{$guess.Letter}}', '{{$guess.Status}}')"
            tabindex="-1"
        >
            {{$guess.Letter}}
        </div>
        {{end}}
    </div>
    {{end}}
</div>

{{if .error}}
<div
    id="error-data"
    data-error="{{.error}}"
    style="display: none"
    aria-hidden="true"
></div>
{{end}} {{if .game.GameOver}}
<div
    class="mt-3 p-3 bg-body-secondary rounded shadow-sm"
    style="max-width: 350px"
    role="region"
    aria-label="Game results"
    aria-live="polite"
>
    {{if .game.Won}}
    <h2 class="text-success text-center h5 mb-2" role="heading" aria-level="2">
        ðŸŽ‰ Congratulations! ðŸŽ‰
    </h2>
    <p class="text-center mb-3 small" role="status">
        You guessed the word in {{len .game.GuessHistory}} {{if eq (len
        .game.GuessHistory) 1}}try{{else}}tries{{end}}!
    </p>
    <div class="d-flex justify-content-center gap-2 mb-2">
        <button
            class="btn btn-primary btn-sm"
            onclick="shareResults()"
            aria-label="Share your game results"
        >
            <i class="bi bi-share" aria-hidden="true"></i> Share Results
        </button>
    </div>
    {{else}}
    <h2 class="text-danger text-center h5 mb-2" role="heading" aria-level="2">
        Game Over!
    </h2>
    <p class="text-center mb-2 small" role="status">
        The word was: <strong>{{.game.TargetWord}}</strong>
    </p>
    <p class="text-center text-muted small mb-3">
        Don't give up! Try again or start a new game.
    </p>
    <div class="d-flex justify-content-center gap-2 mb-2">
        <form method="POST" action="/retry-word" style="display: inline">
            <button
                type="submit"
                class="btn btn-outline-primary btn-sm"
                aria-label="Retry the same word"
            >
                <i class="bi bi-arrow-repeat" aria-hidden="true"></i> Retry Word
            </button>
        </form>
        <button
            class="btn btn-primary btn-sm"
            onclick="location.href='/new-game'"
            aria-label="Start a completely new game"
        >
            <i class="bi bi-arrow-clockwise" aria-hidden="true"></i> New Game
        </button>
    </div>
    <div class="d-flex justify-content-center gap-2">
        <button
            class="btn btn-primary btn-sm"
            onclick="shareResults()"
            aria-label="Share your game results"
        >
            <i class="bi bi-share" aria-hidden="true"></i> Share Results
        </button>
    </div>
    {{end}}
</div>
{{end}} {{end}}
